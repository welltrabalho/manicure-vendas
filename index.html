<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Est√∫dio Luxe Nails</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- Flatpickr CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

<style>
:root{
  --bg:#0b0b0d;
  --panel: rgba(255,255,255,0.04);
  --accent-1: #ff4f9a; 
  --accent-2: #ff77b5; 
  --muted: rgba(255,255,255,0.65);
  --glass-border: rgba(255,255,255,0.06);
  --card: rgba(255,255,255,0.02);
  --success: #25D366;
}

*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:"Inter",system-ui,Arial,sans-serif;background:linear-gradient(180deg,#060607 0%, #0b0b0d 100%);color:#fff;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;padding-bottom:80px;}

/* Decorative top gradient */
.hero-bg{
  position:fixed; inset:0; z-index:0;
  background:
    radial-gradient(800px 300px at 10% 10%, rgba(255,79,154,0.07), transparent 10%),
    radial-gradient(700px 250px at 90% 90%, rgba(255,119,181,0.05), transparent 10%);
  pointer-events:none;
}

/* container central */
.container{
  position:relative;
  z-index:1;
  max-width:1100px;
  margin:36px auto;
  padding:28px;
}

/* header */
.header{
  display:flex;
  gap:16px;
  align-items:center;
  justify-content:space-between;
  flex-wrap:wrap;
  margin-bottom:18px;
}
.brand{
  display:flex;
  gap:14px;
  align-items:center;
}
.logo{
  width:56px;height:56px;border-radius:12px;
  background: linear-gradient(135deg,var(--accent-1),var(--accent-2));
  display:flex;align-items:center;justify-content:center;
  font-weight:800; color:#fff; box-shadow: 0 8px 30px rgba(255,79,154,0.08);
}
.brand h1{font-size:18px;margin:0;letter-spacing:0.2px}
.brand p{margin:0;font-size:12px;color:var(--muted)}

/* nav */
.nav{
  display:flex; gap:8px; align-items:center; flex-wrap:wrap;
}
.btn{
  background:transparent;border:1px solid var(--glass-border);
  padding:9px 12px;border-radius:10px;color:var(--muted);
  text-decoration:none;font-weight:600; transition: all .18s;
}
.btn:hover{ transform:translateY(-2px); box-shadow:0 6px 20px rgba(0,0,0,0.6); color:#fff}
.btn-primary{
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  border:none;color:#fff;padding:10px 14px;border-radius:12px;font-weight:700;
  box-shadow: 0 8px 30px rgba(255,79,154,0.12);
}
.btn-ghost{ background:transparent;border:1px solid rgba(255,255,255,0.03) }

/* main grid */
.grid{
  display:grid;
  grid-template-columns: 1fr 360px;
  gap:20px;
  align-items:start;
}

/* main panel (cards) */
.panel{
  background:var(--panel);
  border-radius:14px;
  padding:18px;
  border:1px solid var(--glass-border);
  backdrop-filter: blur(8px);
  box-shadow: 0 10px 40px rgba(145, 80, 80, 0.6);
}

/* hero card */
.hero-card{
  display:flex; gap:18px; align-items:center;
  padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
  margin-bottom:16px;
}
.hero-card .left{flex:1}
.hero-card h2{margin:0;font-size:20px}
.hero-card p{color:var(--muted);margin-top:6px;font-size:14px}

/* gallery */
.galeria{
  display:grid; grid-template-columns: repeat(3,1fr); gap:10px;
}
.galeria img{
  width:100%; height:110px; object-fit:cover; border-radius:10px;
  transition: transform .28s, box-shadow .28s; border:1px solid rgba(255,255,255,0.02);
}
.galeria img:hover{ transform:translateY(-6px) scale(1.03); box-shadow:0 18px 40px rgba(0,0,0,0.7) }

/* pricing */
.pricing{
  display:flex; gap:10px; margin-top:14px; flex-wrap:wrap;
}
.price{
  flex:1 1 150px;padding:12px;border-radius:10px;background:var(--card); border:1px solid rgba(255,255,255,0.03);
}
.price h3{margin:0;font-size:14px}
.price strong{display:block;margin-top:8px;font-size:18px;color:var(--accent-2)}

/* loja / produtos */
.loja-panel{margin-top:14px}
.loja-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:12px}
.produto{background:var(--card);border:1px solid rgba(255,255,255,0.03);padding:10px;border-radius:10px;text-align:left}
.produto img{width:100%;height:160px;object-fit:cover;border-radius:8px}
.produto img{transition: transform .28s ease}
.produto img:hover{transform:scale(1.04)}
.produto .nome{margin-top:8px;font-weight:700;font-size:14px}
.produto .preco{color:var(--accent-2);font-weight:700;margin-top:6px}
.produto .acoes{display:flex;gap:8px;margin-top:10px}
.produto .acoes .btn-prod{flex:1;padding:8px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
.btn-prod.quero{background:linear-gradient(90deg,var(--accent-1),var(--accent-2));color:#fff}
.btn-prod.duvida{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}

@media(max-width:980px){.loja-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:520px){.loja-grid{grid-template-columns:repeat(1,1fr)}.produto img{height:200px}}

/* right column */
.side{
  display:flex; flex-direction:column; gap:12px;
}
.book-card{
  padding:16px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
}
label{display:block;margin-top:10px;font-size:13px;color:var(--muted)}
input, select{
  width:100%; padding:12px;border-radius:10px;margin-top:8px;border:1px solid rgba(255,255,255,0.04);
  background:transparent;color:#fff;outline:none;
}

/* Flatpickr custom */
.flatpickr-calendar{background:#0b0b0d;color:#fff;border-radius:10px;border:1px solid rgba(255,255,255,0.1);}

/* book button */
.book-btn{
  margin-top:12px;padding:12px;border-radius:12px;border:none;cursor:pointer;
  background: linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#fff;font-weight:700;width:100%;
  box-shadow: 0 10px 30px rgba(255,79,154,0.12);
}
.book-btn:hover{ transform:translateY(-2px)}

/* floating whatsapp */
.wpp{
  position:fixed; right:18px; bottom:18px; z-index:5;
  width:56px;height:56px;border-radius:50%;background:var(--success);display:flex;align-items:center;justify-content:center;color:#fff;
  box-shadow:0 12px 40px rgba(0,0,0,0.6);font-size:20px;
  text-decoration:none;
}

/* admin small link */
.admin-link{font-size:13px;color:var(--muted);text-decoration:none;margin-left:8px}
.admin-link:hover{color:#fff}

/* footer */
.footer{
  margin-top:18px;text-align:center;color:rgba(255,255,255,0.35);font-size:13px;
}

/* responsivo */
@media(max-width:980px){.grid{grid-template-columns:1fr}.galeria{grid-template-columns:repeat(2,1fr)}}
@media(max-width:720px){.side{width:100%}.grid{grid-template-columns:1fr}.nav{flex-wrap:wrap}.hero-card{flex-direction:column;align-items:flex-start}}
@media(max-width:520px){.galeria img{height:90px}}
</style>
</head>
<body>
<div class="hero-bg" aria-hidden="true"></div>

<div class="container">

  <header class="header">
    <div class="brand">
      <div class="logo">LN</div>
      <div>
        <h1>Est√∫dio Luxe Nails</h1>
        <p>Beleza profissional ‚Ä¢ Acabamento premium</p>
      </div>
    </div>

    <nav class="nav">
      <a class="btn" href="#galeria">Galeria</a>
      <a class="btn" href="#precos">Pre√ßos</a>
      <a class="btn" href="#agendar">Agendar</a>
      <a class="btn btn-ghost" href="admin_produtos.html"><i class="fa-solid fa-lock"></i> Painel</a>
    </nav>
  </header>

  <div class="grid">
    <main>

      <section class="panel">
        <div class="hero-card">
          <div class="left">
            <h2>Bem-vinda ao Luxe Nails</h2>
            <p>Traga suas unhas para o pr√≥ximo n√≠vel ‚Äî design, alongamento e manicure com acabamento profissional.</p>
          </div>
          <div style="text-align:right;">
            <a class="btn-primary" href="#agendar">Agendar agora</a>
          </div>
        </div>

        <div id="galeria" class="panel" style="margin-bottom:12px;">
          <h3 style="margin:0 0 8px 0">Transforma√ß√µes recentes</h3>
          <div class="galeria" id="galeriaImgs">
            <img src="imagens/minha.jpg" alt="unha1">
            <img src="imagens/roupas/01.jpeg" alt="unha2">
            <img src="imagens/roupas/02.jpeg" alt="unha3">
            <img src="imagens/roupas/03.jpeg" alt="unha4">
            <img src="imagens/roupas/04.jpeg" alt="unha5">
            <img src="imagens/roupas/05.jpeg" alt="unha6">
          </div>
        </div>

        <div id="precos" class="panel">
          <h3 style="margin:0 0 8px 0">Servi√ßos & Pre√ßos</h3>
          <div class="pricing">
            <div class="price">
              <h3>Manicure</h3>
              <strong>R$ 40</strong>
              <div style="color:var(--muted);font-size:12px;margin-top:6px">Tratamento cl√°ssico</div>
            </div>
            <div class="price">
              <h3>Pedicure</h3>
              <strong>R$ 55</strong>
              <div style="color:var(--muted);font-size:12px;margin-top:6px">Higiene + Esfolia√ß√£o</div>
            </div>
            <div class="price">
              <h3>Alongamento</h3>
              <strong>R$ 150</strong>
              <div style="color:var(--muted);font-size:12px;margin-top:6px">Gel / Fibra</div>
            </div>
          </div>

          <div id="loja" class="panel loja-panel">
            <h3 style="margin:0 0 8px 0">Pe√ßas em destaque</h3>
            <p style="color:var(--muted);margin:0 0 8px 0;font-size:13px">Confira nossas pe√ßas selecionadas ‚Äî pre√ßos vis√≠veis. Gostou ou tem d√∫vida? Fale conosco pelo WhatsApp.</p>

            <div id="lojaGrid" class="loja-grid" aria-live="polite"></div>
            <div id="paginacao" style="margin-top:12px;display:flex;gap:8px;align-items:center;justify-content:center"></div>

            <!-- lightbox/modal -->
            <div id="lightbox" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:50;align-items:center;justify-content:center;padding:24px;transition:opacity .25s ease;opacity:0">
              <div class="lightbox-content" style="position:relative;max-width:900px;width:90%;transform:scale(.95);transition:transform .28s ease,opacity .25s ease;">
                <button id="lbClose" aria-label="Fechar" style="position:absolute;right:8px;top:8px;background:transparent;border:0;color:#fff;font-size:28px;cursor:pointer">√ó</button>
                <button id="lbPrev" aria-label="Anterior" style="position:absolute;left:8px;top:50%;transform:translateY(-50%);background:rgba(0,0,0,0.4);border:0;color:#fff;font-size:26px;padding:8px;border-radius:8px;cursor:pointer">‚Äπ</button>
                <button id="lbNext" aria-label="Pr√≥ximo" style="position:absolute;right:48px;top:50%;transform:translateY(-50%);background:rgba(0,0,0,0.4);border:0;color:#fff;font-size:26px;padding:8px;border-radius:8px;cursor:pointer">‚Ä∫</button>
                <img id="lbImg" src="" alt="" style="width:100%;height:auto;border-radius:10px;display:block;max-height:80vh;object-fit:contain;cursor:zoom-in;transition:transform .28s ease" />
                <div id="lbInfo" style="color:#fff;margin-top:8px;font-size:14px"></div>
              </div>
            </div>
          </div>
        </div>

      </section>
    </main>

    <aside class="side">
      <div class="panel book-card" id="agendar">
        <h3 style="margin:0 0 6px 0">Agende seu hor√°rio</h3>
        <p style="color:var(--muted);margin:0 0 8px 0;font-size:13px">Preencha e envie via WhatsApp ‚Äî tamb√©m salvamos localmente para o Admin.</p>

        <label for="nome">Nome</label>
        <input id="nome" placeholder="Seu nome">

        <label for="telefone">Telefone</label>
        <input id="telefone" placeholder="(DDD) 9 0000-0000">

        <label for="data">Data</label>
        <input id="data" placeholder="Selecione a data">

        <label for="hora">Hora</label>
        <select id="hora">
          <option value="">Selecione</option>
          <option>09:00</option><option>10:00</option><option>11:00</option><option>13:00</option><option>14:00</option><option>15:00</option><option>16:00</option>
        </select>

        <button class="book-btn" id="btnEnviar">Enviar para WhatsApp</button>
        <div id="avisoReserva" role="status" aria-live="polite" style="margin-top:10px;display:none;padding:10px;border-radius:8px;background:rgba(255,79,154,0.08);color:#ffb6d6;font-size:13px;border:1px solid rgba(255,79,154,0.12)"></div>

        <div style="margin-top:12px;font-size:13px;color:var(--muted)">
          <span>Admin:</span>
          <a class="admin-link" href="login.html"><i class="fa-solid fa-lock"></i> Entrar</a>
        </div>
      </div>

      <div class="panel" style="padding:12px;text-align:center">
        <h4 style="margin:0 0 8px 0">Contato r√°pido</h4>
        <div style="color:var(--muted);font-size:13px">WhatsApp ‚Äî Atendimento √°gil</div>
        <div style="margin-top:10px">
          <a class="btn" href="tel:+55219887976236"><i class="fa-solid fa-phone"></i> Ligar</a>
          <a class="btn" style="margin-left:8px" href="mailto:contato@luxenails.com.br"><i class="fa-solid fa-envelope"></i> Email</a>
        </div>
      </div>

    </aside>
  </div>

  <div class="footer">
    ¬© <span id="ano"></span> Luxe Nails ‚Äî Feito com carinho ‚ú®
  </div>
</div>

<a class="wpp" href="https://wa.me/5521988797623" target="_blank" aria-label="WhatsApp"><i class="fa-brands fa-whatsapp"></i></a>

<!-- Flatpickr JS -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<script>
// carregar ano
document.getElementById('ano').textContent = new Date().getFullYear();

// inicializar calend√°rio
flatpickr("#data", {
  dateFormat: "d/m/Y",
  minDate: "today",
  locale: {
    weekdays: { shorthand: ['Dom','Seg','Ter','Qua','Qui','Sex','S√°b'], longhand: ['Domingo','Segunda-feira','Ter√ßa-feira','Quarta-feira','Quinta-feira','Sexta-feira','S√°bado'] },
    months: { shorthand: ['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'], longhand: ['Janeiro','Fevereiro','Mar√ßo','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dez'] }
  },
  onChange: function(selectedDates, dateStr) {
    atualizarHorariosDisponiveis(dateStr);
  }
});

// atualizar hor√°rios dispon√≠veis baseado na data selecionada
function atualizarHorariosDisponiveis(dataSelecionada) {
  const lista = JSON.parse(localStorage.getItem('agendamentos')||'[]');
  const horariosOcupados = lista
    .filter(a => a.data === dataSelecionada)
    .map(a => a.hora);
  
  const selectHora = document.getElementById('hora');
  const opcoes = selectHora.querySelectorAll('option');
  
  opcoes.forEach(opcao => {
    if(opcao.value && horariosOcupados.includes(opcao.value)) {
      opcao.disabled = true;
      opcao.textContent = opcao.value + ' (Ocupado)';
    } else if(opcao.value) {
      opcao.disabled = false;
      opcao.textContent = opcao.value;
    }
  });

  // atualizar aviso caso a op√ß√£o selecionada esteja ocupada
  const horaSelecionada = selectHora.value;
  if(horaSelecionada && horariosOcupados.includes(horaSelecionada)) {
    mostrarAviso('‚ö†Ô∏è Este hor√°rio j√° est√° ocupado. Escolha outro hor√°rio.');
  } else {
    esconderAviso();
  }
}

// verificar se hor√°rio est√° dispon√≠vel
function horarioDisponivel(data, hora) {
  const lista = JSON.parse(localStorage.getItem('agendamentos')||'[]');
  return !lista.some(a => a.data === data && a.hora === hora);
}

// mostrar / esconder aviso inline
function mostrarAviso(msg) {
  const el = document.getElementById('avisoReserva');
  el.textContent = msg;
  el.style.display = 'block';
}
function esconderAviso(){
  const el = document.getElementById('avisoReserva');
  el.textContent = '';
  el.style.display = 'none';
}

// verificar aviso quando usu√°rio muda a hora
document.getElementById('hora').addEventListener('change', function(){
  const data = document.getElementById('data').value;
  const hora = this.value;
  if(!data || !hora){ esconderAviso(); return; }
  if(!horarioDisponivel(data, hora)) {
    mostrarAviso('‚ö†Ô∏è Este hor√°rio j√° est√° ocupado. Escolha outro hor√°rio.');
  } else {
    esconderAviso();
  }
});

// carregar produtos via JSON, renderizar com pagina√ß√£o e galeria
const produtosContainer = document.getElementById('lojaGrid');
const paginacaoEl = document.getElementById('paginacao');
const lightbox = document.getElementById('lightbox');
const lbImg = document.getElementById('lbImg');
const lbInfo = document.getElementById('lbInfo');
const lbClose = document.getElementById('lbClose');

let produtos = [];
let paginaAtual = 1;
const itensPorPagina = 6;

function abrirWhatsAppPara(produto, tipo){
  const numero = '55219887976236';
  let texto = '';
  if(tipo === 'quero') texto = `Ol√°! Tenho interesse na pe√ßa "${produto.nome}" (${produto.preco}). Como fa√ßo para comprar?`;
  else texto = `Ol√°! Tenho uma d√∫vida sobre a pe√ßa "${produto.nome}" (${produto.preco}): `;
  const url = `https://wa.me/${numero}?text=${encodeURIComponent(texto)}`;
  window.open(url, '_blank');
}

let indiceAtual = -1;
function mostrarLightbox(produto, indice){
  indiceAtual = indice !== undefined ? indice : produtos.indexOf(produto);
  lbImg.src = produto.img;
  lbImg.alt = produto.nome;
  lbInfo.textContent = `${produto.nome} ‚Äî ${produto.preco} ‚Äî ${produto.descricao || ''}`;
  lightbox.style.display = 'flex';
  // small enter animation
  requestAnimationFrame(()=>{ lightbox.style.opacity = '1'; document.querySelector('.lightbox-content').style.transform='scale(1)'; });
}

function fecharLightbox(){
  lightbox.style.opacity = '0';
  document.querySelector('.lightbox-content').style.transform='scale(.95)';
  setTimeout(()=>{ lightbox.style.display = 'none'; lbImg.src = ''; indiceAtual = -1; }, 250);
}

lbClose.addEventListener('click', fecharLightbox);
lightbox.addEventListener('click', function(e){ if(e.target === lightbox) fecharLightbox(); });

const lbPrev = document.getElementById('lbPrev');
const lbNext = document.getElementById('lbNext');
function showByIndex(i){
  if(i<0 || i>=produtos.length) return;
  const p = produtos[i];
  indiceAtual = i;
  lbImg.src = p.img;
  lbImg.alt = p.nome;
  lbInfo.textContent = `${p.nome} ‚Äî ${p.preco} ‚Äî ${p.descricao || ''}`;
}
lbPrev.addEventListener('click', ()=>{ if(indiceAtual>0) showByIndex(indiceAtual-1); });
lbNext.addEventListener('click', ()=>{ if(indiceAtual < produtos.length-1) showByIndex(indiceAtual+1); });
document.addEventListener('keydown', function(e){ if(lightbox.style.display==='flex'){
  if(e.key === 'Escape') fecharLightbox();
  if(e.key === 'ArrowLeft') lbPrev.click();
  if(e.key === 'ArrowRight') lbNext.click();
}});

// double click to zoom toggle
lbImg.addEventListener('dblclick', function(){
  if(this.style.transform && this.style.transform.includes('scale(1.6)')){ this.style.transform='scale(1)'; this.style.cursor='zoom-in'; }
  else { this.style.transform='scale(1.6)'; this.style.cursor='zoom-out'; }
});

function renderizarPaginacao(totalItems){
  const totalPaginas = Math.max(1, Math.ceil(totalItems / itensPorPagina));
  paginacaoEl.innerHTML = '';
  if(totalPaginas <= 1) return;

  const btnPrev = document.createElement('button'); btnPrev.className='btn'; btnPrev.textContent='‚Äπ';
  btnPrev.disabled = paginaAtual === 1;
  btnPrev.addEventListener('click', ()=>{ if(paginaAtual>1){ paginaAtual--; renderizarPagina(); } });
  paginacaoEl.appendChild(btnPrev);

  for(let i=1;i<=totalPaginas;i++){
    const b = document.createElement('button'); b.className='btn'; b.textContent = i;
    if(i===paginaAtual) { b.style.background='rgba(255,255,255,0.06)'; }
    b.addEventListener('click', ()=>{ paginaAtual=i; renderizarPagina(); });
    paginacaoEl.appendChild(b);
  }

  const btnNext = document.createElement('button'); btnNext.className='btn'; btnNext.textContent='‚Ä∫';
  btnNext.disabled = paginaAtual === totalPaginas;
  btnNext.addEventListener('click', ()=>{ if(paginaAtual<totalPaginas){ paginaAtual++; renderizarPagina(); } });
  paginacaoEl.appendChild(btnNext);
}

function renderizarPagina(){
  const inicio = (paginaAtual-1)*itensPorPagina;
  const fim = inicio + itensPorPagina;
  const slice = produtos.slice(inicio,fim);
  produtosContainer.innerHTML = '';
  if(slice.length===0){ produtosContainer.innerHTML = '<div style="color:var(--muted);grid-column:1/-1;text-align:center">Nenhum produto encontrado.</div>'; return; }

  slice.forEach((prod, idx)=>{
    const div = document.createElement('div'); div.className='produto';
    // set data-src and a tiny placeholder for IntersectionObserver lazy loading
    const placeholder = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==';
    div.innerHTML = `
      <img class="prod-img" loading="lazy" src="${placeholder}" data-src="${prod.img}" alt="${prod.nome}" />
      <div class="nome">${prod.nome}</div>
      <div class="preco">${prod.preco}</div>
      <div class="acoes">
        <button class="btn-prod quero" data-id="${prod.id}">Quero</button>
        <button class="btn-prod duvida" data-id="${prod.id}">D√∫vida</button>
      </div>`;
    produtosContainer.appendChild(div);
  });

  // listeners
  produtosContainer.querySelectorAll('.btn-prod').forEach(btn=>{
    btn.addEventListener('click', function(){
      const id = Number(this.dataset.id);
      const produto = produtos.find(p=>p.id===id);
      if(!produto) return;
      const tipo = this.classList.contains('quero') ? 'quero' : 'duvida';
      abrirWhatsAppPara(produto, tipo);
    });
  });

  produtosContainer.querySelectorAll('.prod-img').forEach(img=>{
    img.addEventListener('click', function(){
      const src = this.src;
      const nome = this.alt;
      const produto = produtos.find(p=>p.img === src || p.nome === nome);
      if(produto) mostrarLightbox(produto);
    });
  });
  // setup lazy loading for images rendered in this page
  setupLazyLoad();

  renderizarPaginacao(produtos.length);
}

// buscar produtos
fetch('produtos.json').then(r=>r.json()).then(data=>{
  produtos = data;
  paginaAtual = 1;
  renderizarPagina();
}).catch(err=>{
  produtosContainer.innerHTML = '<div style="color:var(--muted);grid-column:1/-1;text-align:center">Erro ao carregar produtos.</div>';
  console.error('Erro fetch produtos:', err);
});

// IntersectionObserver based lazy load
let _lazyObserver = null;
function setupLazyLoad(){
  const imgs = document.querySelectorAll('img[data-src]');
  if('IntersectionObserver' in window){
    if(!_lazyObserver){
      _lazyObserver = new IntersectionObserver((entries, obs)=>{
        entries.forEach(entry=>{
          if(entry.isIntersecting){
            const img = entry.target;
            img.src = img.dataset.src;
            img.removeAttribute('data-src');
            obs.unobserve(img);
          }
        });
      },{rootMargin:'100px'});
    }
    imgs.forEach(i=>{ if(i.dataset.src) _lazyObserver.observe(i); });
  } else {
    // fallback: load all
    imgs.forEach(i=>{ i.src = i.dataset.src; i.removeAttribute('data-src'); });
  }
}

// enviar agendamento
document.getElementById('btnEnviar').addEventListener('click', function(){
  const nome = document.getElementById('nome').value.trim();
  const tel = document.getElementById('telefone').value.trim();
  const data = document.getElementById('data').value;
  const hora = document.getElementById('hora').value;
  if(!nome || !tel || !data || !hora){ alert('Preencha todos os campos'); return; }

  // verificar se o hor√°rio est√° dispon√≠vel
  if(!horarioDisponivel(data, hora)) {
    alert('‚ö†Ô∏è Este hor√°rio j√° est√° ocupado! Por favor, escolha outro hor√°rio.');
    return;
  }

  const lista = JSON.parse(localStorage.getItem('agendamentos')||'[]');
  lista.push({nome,tel,data,hora, criado: new Date().toISOString()});
  localStorage.setItem('agendamentos', JSON.stringify(lista));

  const numero = '5521973792087';
  const msg = `Ol√°! Quero agendar:%0ANome: ${encodeURIComponent(nome)}%0ATelefone: ${encodeURIComponent(tel)}%0AData: ${data}%0AHora: ${hora}`;
  window.open(`https://wa.me/${numero}?text=${msg}`, '_blank');
  alert('Agendamento enviado! Obrigada üòä');
  document.getElementById('nome').value=''; document.getElementById('telefone').value=''; document.getElementById('data').value=''; document.getElementById('hora').value='';
});
</script>
</body>
</html>
